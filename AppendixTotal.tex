\documentclass[main.tex]{subfiles}
\input{ExtraDefinitions.tex}

\begin{document}
%\renewcommand{\chaptername}{}
%\renewcommand{\thechapter}{}
%\renewcommand{\thetable}{A.\arabic{table}}
%\renewcommand{\thesection}{B.\arabic{section}}
%\renewcommand{\thesubsection}{C.\arabic{subsection}}
%\renewcommand{\theequation}{A.\arabic{equation}}

\chapter{One-Loop Results}
\label{app:oneloop}
In this Appendix, we collect the numerical results relevant to the amplitudes presented in Chapters~\ref{sec:Hbb} and \ref{sec:Wyj}. Tables~\ref{tab:benchmarkbare1L} and \ref{Wyjtab:benchmark1Lnf0bare} show the bare one-loop amplitudes (normalised by the tree-level amplitudes) for the two processes $\ppbbh$ and $\ppWgj$, respectively. Tables~\ref{tab:benchmarkfinremsq1L} and ~\ref{Wyjtab:benchmarkfinremsq1L} show the corresponding reduced squared tree-level amplitudes $\cH^{(0)}$ and reduced squared one-loop finite remainders (normalised by $\cH^{(0)}$).
\begin{table}[t!]
\centering
\begin{tabularx}{1.0\textwidth}{|C{0.7}|C{0.8}|C{0.5}|C{1.2}|C{1.2}|C{1.3}|C{1.3}|}
\hline
 $\bbggh$     & helicity & $\eps^{-2}$ & $\eps^{-1}$ & $\eps^{0}$ & $\eps^{1}$ & $\eps^{2}$ \\
\hline
$\hat A^{(1),1}$ & $++++$ & $ -3 $ & $ 3.07857 - 3.14159 i$ & $ 0.317351 + 8.42128 i$ & $ -1.25257 - 8.56907 i$ & $ 25.8294 - 4.35648 i $ \\
                 & $+++-$ & $ -3 $ & $ 3.07857 - 3.14159 i$ & $ -2.99786 - 1.02133 i$ & $ 2.86487 - 28.7164 i$ & $ 30.3093 - 26.3373 i $ \\
                 & $++-+$ & $ -3 $ & $ 3.07857 - 3.14159 i$ & $ -0.119814 + 8.67497 i$ & $ -1.43041 - 5.33656 i$ & $ 19.6373 - 0.110475 i $ \\
                 & $++--$ & $ -3 $ & $ 3.07857 - 3.14159 i$ & $ -6.51606 + 18.6156 i$ & $ -21.7849 + 24.0036 i$ & $ -24.6605 + 55.6878 i $ \\
\hline
$\hat A^{(1),n_f}$ & $++++$ & $ 0$ & $ 0$ & $ -0.005010 + 0.000779871 i$ & $ -0.00700827 - 0.0150298 i$ & $ 0.0109029 - 0.0163643 i $ \\
                   & $+++-$ & $ 0$ & $ 0$ & $ 0$ & $ 0$ & $ 0 $ \\
                   & $++-+$ & $ 0$ & $ 0$ & $ 0$ & $ 0$ & $ 0 $ \\
                   & $++--$ & $ 0$ & $ 0$ & $ -0.393552 + 0.138515 i$ & $ -0.793221 - 1.11035 i$ & $ 0.635641 - 1.48796 i $ \\
\hline
$\bbqqh$     & helicity & $\eps^{-2}$ & $\eps^{-1}$ & $\eps^{0}$ & $\eps^{1}$ & $\eps^{2}$ \\
\hline
$\hat A^{(1),1}$ & $+++-$ & $ -2 $ & $ 2.48840$ & $ -9.99430 - 8.95182 i$ & $ 2.20899 - 24.3401 i$ & $ 4.76962 - 27.6604 i $ \\
                 & $++-+$ & $ -2 $ & $ 2.48840$ & $ -8.43825 - 7.45006 i$ & $ 7.21741 - 24.6383 i$ & $ 13.6369 - 20.4876 i $ \\
\hline
$\hat A^{(1),n_f}$ & $+++-$ & $ 0$ & $ -0.666667$ & $ 0.726782 - 2.09440 i$ & $ 2.29387 + 2.28325 i$ & $ -2.54017 + 0.316127 i $ \\
                   & $++-+$ & $ 0$ & $ -0.666667$ & $ 0.726782 - 2.09440 i$ & $ 2.29387 + 2.28325 i$ & $ -2.54017 + 0.316127 i $ \\
\hline
\end{tabularx}
\caption{\label{tab:benchmarkbare1L} Numerical values of the bare $\bbggh$ and $\bbqqh$ partial amplitudes at one loop (normalised to the tree-level amplitude) at the kinematic point in 
Eq.~\eqref{eq:physicalpointHbbMomTwistor} for the four independent helicity configurations and the various closed fermion loops contributions. }
\end{table}

\begin{table}[t!]
\centering
\begin{tabularx}{0.85\textwidth}{|C{0.7}|C{1.1}|C{1.1}|C{1.1}|}
\hline
channel & $\mathcal{H}^{(0)}$ & $\mathrm{Re}\;\mathcal{H}^{(1),1}$ & $\mathrm{Re}\;\mathcal{H}^{(1),n_f}$  \\
\hline
$\mathbf{gg}$       & $ 1121.375369 $    & $ 4905.689964$ & $ 204.1069797 $ \\
$\mathbf{q\bar{q}}$ & $ 0.001095232986 $ & $ -0.008958148524$ & $ 0.0007959961305 $ \\
$\mathbf{\bar{q}q}$ & $ 0.001095232986 $ & $ 0.01182947634$ & $ 0.0007959961305 $ \\
$\mathbf{b\bar{b}}$ & $ 738.4111805 $ & $ 5948.275150$ & $ -2005.976183 $ \\
$\mathbf{\bar{b}b}$ & $ 774.9861507 $ & $ -8346.007933$ & $ -2253.325645 $ \\
$\mathbf{bb}/\mathbf{\bar{b}\bar{b}}$ & $ 71.81424881 $  & $ -678.1382010$ & $ -243.5040325 $ \\
\hline
\end{tabularx}
\caption{\label{tab:benchmarkfinremsq1L} Numerical values of the tree-level reduced squared amplitudes  $\mathcal{H}^{(0)}$ and 
one-loop reduced squared finite remainders $\mathcal{H}^{(1)}$ 
defined in Eqs.~\eqref{eq:channel_gg}-\eqref{eq:channel_BB} at the kinematic point in 
Eq.~\eqref{eq:physicalpointHbbMomTwistor} for  the closed fermion loops contributions and the scattering channels specified in Eq.~\eqref{eq:channel_definition}.}
\end{table}

\begin{table}[t!]
\centering
\begin{tabularx}{1.0\textwidth}{|C{0.7}|C{1.0}|C{0.6}|C{1.0}|C{1.2}|C{1.2}|C{1.3}|}
\hline
      & helicity & $\eps^{-2}$ & $\eps^{-1}$ & $\eps^{0}$ & $\eps^{1}$ & $\eps^{2}$ \\
\hline
$\hat A^{(1),1}_u$ & $\scriptstyle +++--+$ & -2 & 23.8477 & $-138.615 - 2.09370  i$ & $523.949 + 12.3666 i$ & $-1448.23 - 21.7701 i$ \\
                   & $\scriptstyle -++--+$ & -2 & 23.8477 & $-139.779 - 0.516164 i$ & $535.218 - 2.01397 i$ & $-1503.32 + 46.1044 i$ \\
\hline
$\hat A^{(1),1}_d$ & $\scriptstyle +++--+$ & -2 & 23.8477 & $-140.008 - 2.18806 i$  & $539.871 + 13.7461 i$ & $-1538.48 - 30.4669 i$ \\
                   & $\scriptstyle -++--+$ & -2 & 23.8477 & $-139.294 - 2.18046 i$  & $532.471 + 15.2170 i$ & $-1499.51 - 44.3866 i$ \\
\hline
$\hat A^{(1),1}_W$ & $\scriptstyle +++--+$ & -2 & 23.8477 & $-139.550 - 1.53563 i$  & $534.185 + 8.26368 i$ & $-1503.99 - 6.62167 i$ \\
                   & $\scriptstyle -++--+$ & -2 & 23.8477 & $-139.818 - 1.20381 i$  & $536.639 + 5.03856 i$ & $-1515.10 + 9.39205 i$ \\
\hline
$\hat A^{(1),1}_e$ & $\scriptstyle +++--+$ & -2 & 23.8477 & $-139.570 - 1.46851 i$  & $534.360 + 7.61926 i$ & $-1504.71 - 3.48177 i$ \\
                   & $\scriptstyle -++--+$ & -2 & 23.8477 & $-140.303 - 1.48855 i$  & $541.353 + 7.64165 i$ & $-1538.44 - 2.31498 i$ \\
\hline
\end{tabularx}
\caption{\label{Wyjtab:benchmark1Lnf0bare} 
Bare one-loop helicity sub-amplitudes (normalised to the tree-level amplitudes as in Eq.~\eqref{Wyjeq:treenorm}) without any closed fermion loop contribution  
for $\wpaj$ production in the $\mathbf{u\bar{d}}$ scattering channel 
evaluated at the kinematic point given in Eq.~\eqref{Wyjeq:PSpoint}. The results are shown for the two independent helicity configurations and obtained with $q_1 = p_3$ and $q_3 = p_1$ where $q_1$ ($q_3$) is the 
reference momentum for the photon (gluon) polarisation vector.
}
\end{table}

\begin{table}[t!]
\centering
\begin{tabularx}{1\textwidth}{|C{0.4}|C{1.2}|C{1.2}|C{1.2}|}
\hline
$W^+\gamma j$ & $\mathcal{H}^{(0)}  \; [\times 10^{-10}\,\mathrm{GeV}^{-4}] $ & $\mathrm{Re}\;\hat{\mathcal{H}}^{(1),1}$ & $\mathrm{Re}\;\hat{\mathcal{H}}^{(1),n_f}$  \\
\hline
$\mathbf{u\bar{d}}$ & 32.9224527109  & -20.4269208141 & 4.22462265354  \\
$\mathbf{\bar{d}u}$ & 35.8863373066  & -20.0350027848 & 4.22462265354  \\
$\mathbf{ug}      $ & 4.84655650134  & -26.9389515414 & 4.45445318051  \\
$\mathbf{gu}      $ & 15.2151742999  & -25.3235043118 & 4.37533965902  \\
$\mathbf{\bar{d}g}$ & 9.18270882925  & -28.3542876136 & 4.45445318051  \\
$\mathbf{g\bar{d}}$ & 26.4333120479  & -27.3120879601 & 4.37533965902  \\
\hline
\hline
$W^-\gamma j$ & $\mathcal{H}^{(0)}  \; [\times 10^{-10}\,\mathrm{GeV}^{-4}] $ & $\mathrm{Re}\;\hat{\mathcal{H}}^{(1),1}$ & $\mathrm{Re}\;\hat{\mathcal{H}}^{(1),n_f}$  \\
\hline
$\mathbf{d\bar{u}}$ & 48.5521763841  & -20.5759435967 & 4.22462265354  \\
$\mathbf{\bar{u}d}$ & 5.60724308955  & -25.0921274652 & 4.22462265354  \\
$\mathbf{dg}      $ & 0.161819754065 & -53.2745933316 & 4.45445318051  \\
$\mathbf{gd}      $ & 2.59919214772  & -35.7387232774 & 4.37533965902  \\
$\mathbf{\bar{u}g}$ & 0.471356750696 & -25.5067063821 & 4.45445318051  \\
$\mathbf{g\bar{u}}$ & 27.6357549618  & -32.8902240077 & 4.37533965902  \\
\hline
\end{tabularx}
\caption{\label{Wyjtab:benchmarkfinremsq1L} 
Reduced squared tree-level amplitude (absolute) and reduced squared one-loop finite remainders (normalised to the reduced squared tree amplitudes)
for the various closed fermion loop contributions and scattering channels of both $pp\to\wpaj$ and $pp\to\wmaj$ production,
evaluated at the kinematic point given in Eq.~\eqref{Wyjeq:PSpoint}.
}
\end{table}

\chapter{Derivation of the pole structure} \label{app:polestructure}
In the following, we provide a detailed derivation of the full pole structure of the $\ppbbh$ amplitudes presented in Eqs.~\ref{eq:poles1L} to \ref{eq:H2bbggH}. We do this for completeness, but also in the hope of illuminating the procedure, which can be far from obvious. We also outline the analogous calculation for the $0\to \ell \bar\ell \gamma \gamma^*$ amplitudes of Chapter~\ref{sec:QEDpaper}.
\section{UV singularities}
Let us start with the UV singularities. Renormalising the amplitude amounts to replacing the bare couplings in the Lagrangian with the physical ones according to:
\begin{equation}
    x_B = Z_x x_R \,.
\end{equation}
The renormalisation factors are expanded as $Z_x = 1 + \delta_x$, where $\delta_x$ are the counterterms added to the bare Lagrangian and which are designed precisely to cancel out the divergences. Thus, we can think of renormalisation as absorbing the infinities from $x_B$ into $Z_x$. Then, working with the renormalised parameters $x_R$ in the Lagrangian is known as `renormalised perturbation theory'. Let us now see how to achieve that. Specifying to the case of the $\ppbbh$ process in Sec.~\ref{sec:Hbb}, the bare amplitude admits the following expansion (similar to that of Eq.~\ref{eq:ampexpansion})\footnote{See Refs.~\cite{Ahmed:2014pka, Mondini:2019vub} for details, but note the difference of $\alpha_{s,B}^{1/2}$ as the leading power due to one fewer jet and, in the second reference, the expansion in powers of $\alpha_{s,B}/(2 \pi)$, which introduces relative factors of $2$ with respect to our convention.}:
\begin{equation} \label{eq:ampexpbare}
    A_B = a_B y_{b,B} \left(A_B^{(0)} + a_B A_B^{(1)} + a_B^2 A_B^{(2)} + \ldots \right)\,,
\end{equation}
where $a_B = \alpha_{s,B}/(4\pi)$ and $\alpha_{s,B}\,$,  $y_{b,B}$ are the bare strong coupling constant and the bare Yukawa coupling of the $b$ quark. We will work in the $\overline{\text{MS}}$ scheme and make the following replacements for the two couplings\footnote{We treat all quarks as massless, while the wave function renormalisation factor $Z_A$ in the on-shell scheme is just 1 \JK{Citation here!!!}(see Sec.~\ref{Hbbsec:amp} for an explanation as to why we use a mixed renormalisation scheme). Therefore, we only renormalise the strong coupling constant and the $b$ quark Yukawa coupling.}:
\begin{align}
    \alpha_{s,B} &= S_\eps\, Z_{\alpha_s} \, \alpha_{s,R}(\mu_R), \label{eq:baretorenormalpha} \\
    y_{b,B} &= Z_y \, y_{b,R}(\mu_R) \label{eq:baretorenormyb} \,,
\end{align}
where $\mu_R$ is the renormalisation scale. The factor $S_\eps = e^{\eps \gamma_E} (4\pi)^{-\eps}$ cancels out with the $m_\eps$ factor extracted from the colour-ordered amplitudes in Eq.~\ref{eq:colourdecomposition} and so will be dropped in the following discussion. The renormalisation factors themselves admit a perturbative expansion in the renormalised strong coupling constant:
\begin{align}
    Z_{\alpha_s} &= 1 + a_R r_1 + a_R^2 r_2 + \order{a_R^3},  \label{eq:Zalphacoeff} \\
    Z_y &= 1 + a_R s_1 + a_R^2 s_2 + \order{a_R^3} \label{eq:Zybcoeff}\,,
\end{align}
where $a_R = \alpha_{s,R}/(4\pi)$. Substituting Eqs.~\ref{eq:baretorenormalpha} through \ref{eq:Zybcoeff} into Eq.~\ref{eq:ampexpbare}, we obtain the amplitude expansion in terms of the renormalised parameters:
\begin{equation} \label{eq:ampexprenorm}
    A_R = a_R y_{b,R} \left(A_R^{(0)} + a_R A_R^{(1)} + a_B^2 A_R^{(2)} + \ldots \right)\,,
\end{equation}
with the individual amplitudes given by:
\begin{align}
    A_R^{(0)} &= A_B^{(0)} \,,\nonumber \\ 
    A_R^{(1)} &= A_B^{(1)} + 2 A_B^{(0)}(r_1 + s_1) \,, \label{eq:amprenorminbare}\\ 
    A_R^{(2)} &= A_B^{(2)} + 2 A_B^{(1)}(2r_1 + s_1) + 4A_B^{(0)} (r_2 + r_1 s_1 + s_2)\,. \nonumber
\end{align}
The coefficients $r_1, r_2, s_1, s_2$ are listed in Appendix~\ref{app:renormconstants}. Note that we use their values as given in Ref.~\cite{Mondini:2019vub} for the sake of consistency, but in Eq.~\ref{eq:amprenorminbare} we have rescaled them by powers of 2 to make them compatible with our expansion). Overall, we see that each UV-finite amplitude $A_R^{(L)}$ is defined by adding to the bare amplitude $A_B^{(L)}$ terms related to the $\beta$-function whose $\eps$ poles cancel out the UV divergences. This completes the renormalisation of the $\ppbbh$ amplitudes in Chapter~\ref{sec:Hbb}.
\section{IR singularities}
The renormalised amplitudes $A_R^{(L)}$ are only UV-finite --- the IR divergences remain. As explained in Sec.~\ref{sec:IRdivergencesandKLN}, the IR pole structure of two-loop amplitudes in massless gauge theories was originally derived in Ref.~\cite{Catani:1998bh} and later extended in  Refs.~\cite{Becher:2009cu, Becher:2009qa, Gardi:2009qi}. Here, we provide a brief summary of these results, followed by their application to our process of interest, $\ppbbh$.
\subsection{Overview of IR singularities}
The $\overline{\text{MS}}$-renormalised amplitudes $A_R^{(L)}$ admit the following structure\footnote{Note that similarly to the previous section, we rescale $\bm{I}^{(1)}(\eps)$ and $\bm{I}^{(2)}(\eps)$ by $2$ and $2^2$, respectively, to account for the different expansion parameter $a_R$ in Ref.~\cite{Catani:1998bh}.}:
\begin{align}
    A_R^{(1)} &= 2\bm{I}^{(1)}(\eps) A_R^{(0)} + F^{(1)}\,, \label{eq:A1IRstructure} \\
    A_R^{(2)} &= 2\bm{I}^{(1)}(\eps) A_R^{(1)} + 4\bm{I}^{(2)}(\eps) A_R^{(0)} + F^{(2)} \,. \label{eq:A2IRstructure}
\end{align}
Thus, the IR-divergent part is determined by amplitudes at lower loop order, while the full amplitude also receives a finite part $F^{(L)}$, which is the genuinely new contribution that needs to be computed. The pole operators are given by~\cite{Catani:1998bh}:
\begin{align}
    \bm{I}^{(1)}(\eps) &= \frac{1}{2} \frac{e^{\eps \gamma_E}}{\Gamma(1-\eps)} \sum_i \left(\frac{1}{\eps^2} - \frac{\gamma_0^i}{2\eps} \frac{1}{\bm{T}_i^2}\right) \sum_{j\neq i} \bm{T}_j \cdot \bm{T}_j \left(\frac{\mu_R^2}{-s_{ij}} \right)^\eps\,, \\
    \bm{I}^{(2)}(\eps) &= \frac{e^{-\eps \gamma_E} \Gamma(1-2\eps)}{\Gamma(1-\eps)} \left( \frac{\gamma_1^\text{cusp}}{8} + \frac{\beta_0}{2\eps} \right) \bm{I}^{(1)}(2\eps) - \frac{1}{2}\bm{I}^{(1)}(\eps) \left(\bm{I}^{(1)}(\eps) + \frac{\beta_0}{\eps} \right) + \bm{H}_{\text{RS}}^{(2)}(\eps)\,,
\end{align}
where $s_{ij} = 2\sigma_{ij} p_i \cdot p_j$ with $\sigma_{ij}=+1$ if both momenta are incoming or outgoing and $\sigma_{ij}=-1$ otherwise. The values of the $\beta$-function coefficients and the anomalous dimensions are given in Appendix~\ref{app:renormconstants}. We remark that the one-loop pole operator $\bm{I}^{(1)}(\eps)$ is independent of the regularisation scheme, while the two-loop operator $\bm{I}^{(2)}(\eps)$ is not. Its dependence enters through the quantity $\bm{H}_{\text{RS}}^{(2)}(\eps)$, which contains $\order{1/\eps}$ poles only:
\begin{align} \label{eq:IR_H_function}
    \bm{H}_{\text{RS}}^{(2)}(\eps) &= \frac{1}{16\eps} \sum_i \left(\gamma_1^i - \frac{1}{4} \gamma_1^{\text{cusp}}\gamma_0^i + \frac{\pi^2}{16} \beta_0 \gamma_0^{\text{cusp}} C_i \right) \nonumber \\
    &+ \frac{i f^{abc}}{24\eps} \sum_{(i,j,k)} \bm{T}_i^a \bm{T}_j^b \bm{T}_k^c \ln\left(\frac{-s_{ij}}{-s_{jk}} \right) \ln\left(\frac{-s_{jk}}{-s_{ki}} \right) \ln\left(\frac{-s_{ki}}{-s_{ij}} \right) \\ 
    &-\frac{i f^{abc}}{128\eps} \gamma_0^{\text{cusp}} \sum_{(i,j,k)} \bm{T}_i^a \bm{T}_j^b \bm{T}_k^c \left( \frac{\gamma_0^i}{C_i} - \frac{\gamma_0^j}{C_j} \right)\ln\left(\frac{-s_{ij}}{-s_{jk}} \right) \ln\left(\frac{-s_{ki}}{-s_{ij}} \right)\,, \nonumber
\end{align}
where the sum runs over unordered tuples $(i,j,k)$ of distinct parton indices. As pointed out in Ref.~\cite{Becher:2009cu}, the last two lines appear only because the pole operators $\bm{I}^{(L)}(\eps)$ formulated in Ref.~\cite{Catani:1998bh} were not defined in a minimal scheme, but also include terms finite in $\eps$. Due to colour conservation, they contribute only if the amplitude contains at least four partons \JK{The last line appears only for \textit{more} than 4 partons due to momentum conservation (Becher+Neubert). But the 2nd line should still be present for bbH, since we have exactly 4 partons and we are working in $\overline{\text{MS}}$ scheme. What's going on?}.

Overall, despite the intimidating appearance of the formulas above, it can be appreciated that the only non-trivial piece of deriving the pole structure of the two-loop amplitudes is due to the operators $\bm{T}_i^a$, which we will refer to as `colour insertion operators'. Indeed, each $\bm{T}_i^a$ acts on the colour structure of the amplitude by inserting a gluon with the adjoint index $a$ onto the parton $i$. The rules are as follows:
\begin{itemize}
    \item $\bm{T}_c^a: \delta^{bc} = -\ii f^{abc}$ if $c$ is a gluon
    \item $\bm{T}_i^a: \delta_{ij} = + (T^a)_{ij}$ if $i$ is an outgoing quark 
    \item $\bm{T}_i^a: \delta_{ji} = - (T^a)_{ji}$ if $i$ is an outgoing antiquark
    \item $\bm{T}_i^a: \delta_{ji} = - (T^a)_{ji}$ if $i$ is an incoming quark
    \item $\bm{T}_i^a: \delta_{ij} = + (T^a)_{ij}$ if $i$ is an incoming antiquark
\end{itemize}
We find it very helpful to use pictures akin to Feynman diagrams in order to better understand these rules (see  Fig.~\ref{fig:colourinsertion}). 
\begin{figure}
    \centering
    %\begin{adjustbox}{minipage=\textwidth,scale=0.9}
    %\raisebox{0.2cm}{
    \begin{subfigure}[b]{0.8\linewidth}
        \hspace*{1em}
        \begin{tikzpicture}[every text node part/.style={align=left}]
    	\begin{feynman}[small]
    		\vertex (v) node[anchor=north] {$b$};
            \vertex (f) [right=2cm of v] {$\phantom{i_1}$};
            \node at (f.south west) {$c$};
            \node (t) [left=0.5cm of v] {$\bm{T}^a_c:$};
            \node (eq) [right=0.5cm of f] {$=$};

            \vertex (v2) [right=0.5cm of eq] {$-\ii$};
            \node at (v2.south east) {$b$};
            \vertex (m) [right=1.3cm of v2] [anchor=west];
            \vertex (f2) [right=1.2cm of m] {\phantom{j}};
            \node at (f2.south west) {$c$};
            \vertex (g) [above=of m] {$a$};

            \node (text) [right=1.7cm of f2] {gluon};
            
    		\diagram*{
    			(v) -- [thick, gluon] (f);
                (v2) -- [thick, gluon] (m) -- [thick, gluon] (f2);
                (m) -- [thick, gluon] (g);
    		};
    	\end{feynman}
    \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[b]{0.8\linewidth}
        \hspace*{1em}
        \begin{tikzpicture}[every text node part/.style={align=left}]
    	\begin{feynman}[small]
    		\vertex (v) node[anchor=north] {$j$};
            \vertex (f) [right=2cm of v] {$\phantom{i_1}$};
            \node at (f.south west) {$i$};
            \node (t) [left=0.5cm of v] {$\bm{T}^a_i:$};
            \node (eq) [right=0.5cm of f] {$=$};

            \vertex (v2) [right=0.5cm of eq] {$+$};
            \node at (v2.south east) {$j$};
            \vertex (m) [right=1.3cm of v2] [anchor=west];
            \vertex (f2) [right=1.2cm of m] {\phantom{j}};
            \node at (f2.south west) {$i$};
            \vertex (g) [above=of m] {$a$};

            \node (text) [right=2cm of f2] {outgoing\\quark};
            
            \filldraw (v) circle (2pt);
            \filldraw (v2.east) circle (2pt);
            
    		\diagram*{
    			(v) -- [thick, fermion] (f);
                (v2) -- [thick, fermion] (m) -- [thick, fermion] (f2);
                (m) -- [thick, gluon] (g);
    		};
    	\end{feynman}
    \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[b]{0.8\linewidth}
        \hspace*{1em}
        \begin{tikzpicture}[every text node part/.style={align=left}]
    	\begin{feynman}[small]
    		\vertex (v) node[anchor=north] {$j$};
            \vertex (f) [right=2cm of v] {$\phantom{i_1}$};
            \node at (f.south west) {$i$};
            \node (t) [left=0.5cm of v] {$\bm{T}^a_i:$};
            \node (eq) [right=0.5cm of f] {$=$};

            \vertex (v2) [right=0.5cm of eq] {$-$};
            \node (c) at (v2.south east) {$j$};
            \vertex (m) [right=1.3cm of v2] [anchor=west];
            \vertex (f2) [right=1.2cm of m] {\phantom{j}};
            \node at (f2.south west) {$i$};
            \vertex (g) [above=of m] {$a$};

            \node (text) [right=2cm of f2] {outgoing\\antiquark};
            
            \filldraw (v) circle (2pt);
            \filldraw (v2.east) circle (2pt);
            
    		\diagram*{
    			(v) -- [thick, anti fermion] (f);
                (v2) -- [thick, anti fermion] (m) -- [thick, anti fermion] (f2);
                (m) -- [thick, gluon] (g);
    		};
    	\end{feynman}
    \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[b]{0.8\linewidth}
        \hspace*{1em}
        \begin{tikzpicture}[every text node part/.style={align=left}]
    	\begin{feynman}[small]
    		\vertex (v) node[anchor=north] {$i$};
            \vertex (f) [right=2cm of v] {$\phantom{i_1}$};
            \node at (f.south west) {$j$};
            \node (t) [left=0.5cm of v] {$\bm{T}^a_i:$};
            \node (eq) [right=0.5cm of f] {$=$};

            \vertex (v2) [right=0.5cm of eq] {$-$};
            \node at (v2.south east) {$i$};
            \vertex (m) [right=1.3cm of v2] [anchor=west];
            \vertex (f2) [right=1.2cm of m] {\phantom{j}};
            \node at (f2.south west) {$j$};
            \vertex (g) [above=of m] {$a$};

            \node (text) [right=2cm of f2] {incoming\\quark};
            
            \filldraw (f.west) circle (2pt);
            \filldraw (f2.west) circle (2pt);
            
    		\diagram*{
    			(v) -- [thick, fermion] (f);
                (v2) -- [thick, fermion] (m) -- [thick, fermion] (f2);
                (m) -- [thick, gluon] (g);
    		};
    	\end{feynman}
    \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[b]{0.8\linewidth}
        \hspace*{1em}
        \begin{tikzpicture}[every text node part/.style={align=left}]
    	\begin{feynman}[small]
    		\vertex (v) node[anchor=north] {$i$};
            \vertex (f) [right=2cm of v] {$\phantom{i_1}$};
            \node at (f.south west) {$j$};
            \node (t) [left=0.5cm of v] {$\bm{T}^a_i:$};
            \node (eq) [right=0.5cm of f] {$=$};

            \vertex (v2) [right=0.5cm of eq] {$+$};
            \node at (v2.south east) {$i$};
            \vertex (m) [right=1.3cm of v2] [anchor=west];
            \vertex (f2) [right=1.2cm of m] {\phantom{j}};
            \node at (f2.south west) {$j$};
            \vertex (g) [above=of m] {$a$};

            \node (text) [right=2cm of f2] {incoming\\antiquark};
            
            \filldraw (f.west) circle (2pt);
            \filldraw (f2.west) circle (2pt);
            
    		\diagram*{
    			(v) -- [thick, anti fermion] (f);
                (v2) -- [thick, anti fermion] (m) -- [thick, anti fermion] (f2);
                (m) -- [thick, gluon] (g);
    		};
    	\end{feynman}
    \end{tikzpicture}
    \end{subfigure}
    %}
    %\end{adjustbox}
\caption{Graphical representation of the action of the colour insertion operators on partons. The dot $\bullet$ indicates a Feynman diagram vertex and allows us to distinguish between incoming and outgoing quarks and antiquarks. The fundamental and antifundamental indices should be read in the direction opposite to fermion flow, while the adjoint indices in the three-point gluon vertex should be read anticlockwise.}
\label{fig:colourinsertion}
\end{figure}
Before applying them to our process of interest, it is useful to note that the product of two colour insertion operators, $\bm{T}_i\cdot\bm{T}_j \equiv \bm{T}_i^a \bm{T}_j^a$, trivially commutes: 
\begin{equation} \label{eq:TiTjcommute}
    \bm{T}_i\cdot\bm{T}_j = \bm{T}_j\cdot\bm{T}_i\,,
\end{equation}
while for $i=j$ the action of the product gives the quadratic Casimir of the appropriate representation of $SU(N_c)$:
\begin{equation} \label{eq:Ti^2eqCi}
    \bm{T}_i^2 = C_i\,,
\end{equation}
with $C_q = C_{\bar{q}} = C_F$ and $C_g=C_A$. Moreover, due to colour conservation:
\begin{align} 
    \sum_{i=1}^n \bm{T}_i^a \ket{A_n} &= 0\,, \label{eq:poleinsertioncheckA} \\
    \sum_{(i,j)} \bm{T}_i \cdot \bm{T}_j = -\sum_i \bm{T}_i^2 &= -\sum_i C_i\,, \label{eq:poleinsertioncheckB}
\end{align}
where $\ket{A_n}$ denotes a vector in the $n$-dimensional colour space, with $A_n$ being the UV-renormalised amplitude of $n$ coloured partons\footnote{For a description of the colour-space formalism, see Ref.~\cite{Catani:1996vz}.}. These equations can be used to check whether we have applied the colour insertion operators to our amplitude correctly.
\subsection{Application to $\ppbbh$ amplitudes}
We now have all the tools to derive the IR pole structure of the $\ppbbh$ amplitudes in Chapter~\ref{sec:Hbb}. First of all, we note that by applying the first line of Eq.~\ref{eq:IR_H_function} to the $\bbqqh$ and $\bbggh$ channels, Eqs.~\ref{eq:H2bbqqH} and \ref{eq:H2bbggH} follow trivially. Then, to derive the two-loop pole operator $\bm{I}^{(2)}(\eps)$, we only need to concern ourselves with the action of the colour insertion operators $\bm{T}_i^a$ within $\bm{I}^{(1)}(\eps)$.
\subsubsection{The $\bbqqh$ channel}
As the first step, we write down all the colour structures that appear in the relevant Feynman diagrams. Note that factors such as $N_c, T_F, C_A$ or $C_F$ are not considered a part of these structures --- we only include $\delta$-functions, fundamental generators $(T^a)_{ij}$ and the structure constants $f^{abc}$. For this channel, we find two structures (see Fig.~\ref{fig:bbqqHcolour}):
\begin{equation}
    \bm{c} = 
    \begin{pmatrix}
        \delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3} & \quad \delta_{i_2}^{\;\;\bar{i}_1} \delta_{i_4}^{\;\;\bar{i}_3}
    \end{pmatrix}^T\,.
\end{equation}
Then, the action of the products $\bm{T}_i \cdot \bm{T}_j$ produces a linear combination of these structures, which we encode in the matrices $\mathcal{C}_{ij}$ defined as follows:
\begin{equation}
    \bm{T}_i \cdot \bm{T}_j :  \bm{c} = \mathcal{C}_{ij} \bm{c}\,.
\end{equation}
Note that we do not have to compute $\mathcal{C}_{ij}$ for all possible combinations of $i$ and $j$. Due to Eq.~\ref{eq:Ti^2eqCi}, all $\mathcal{C}_{ii}$ are diagonal and their entries are given by the quadratic Casimirs $C_i$ in the relevant representation. Moreover, the commutativity property Eq.~\ref{eq:TiTjcommute} further reduces the number of necessary computations. Overall, for $n$ coloured partons, we only need to compute $n(n+1)/2$ matrices.
\begin{figure}
    \centering
        \begin{tikzpicture}
        	\begin{feynman}[small]
        		\vertex (v1);
          
        		\vertex[above left = 1cm of v1] (i1) {$i_4$};
        		\vertex[below left =  1cm of v1] (i2) {$\bar{i}_3$};
        		\vertex[right = of v1] (v2);			
        		
        		\vertex[above right = 1cm of v2] (f1) {$\bar{i}_1$};
        		\vertex[below right = 1cm of v2] (f2) {$i_2$};

                %2nd diagram
                \vertex[below right=of f1, xshift=1.5cm] (2i1) {$i_4$};
                \vertex[above right=of f2, xshift=1.5cm] (2i2) {$\bar{i}_3$};
                		
        		\vertex[right=2cm of 2i1] (2f1) {$\bar{i}_1$};
                \vertex[right=2cm of 2i2] (2f2) {$i_2$}; 

                %3rd diagram
                \vertex[above right=of 2f1, xshift=1cm] (3i1) {$i_4$};
                \vertex[below right=of 2f2, xshift=1cm] (3i2) {$\bar{i}_3$};
                		
        		\vertex[right=of 3i1] (3f1) {$\bar{i}_1$};
                \vertex[right=of 3i2] (3f2) {$i_2$}; 

                %equation nodes
                \node[right=2.5cm of v1] {$=T_F$ \Huge $\Biggr($};
                \node[right=6.5cm of v1] {$ -\,\,\dfrac{1}{N_c} $};
                \node[right=9cm of v1] {\Huge $\Biggr)$};

        		\diagram*{
                    %1st diagram
        			(i1) -- [anti fermion] (v1) -- [anti fermion] (i2),
                    (v1) -- [gluon] (v2),
        			(f1) -- [fermion] (v2) -- [fermion] (f2),
                    %2nd diagram
                    (2i1) -- [anti fermion] (2f1),
                    (2i2) -- [fermion] (2f2),
                    %3rd diagram
                    (3i1) -- [anti fermion] (3i2),
                    (3f1) -- [fermion] (3f2),
        		};
        	\end{feynman}
        \end{tikzpicture}
    \caption{The colour structure of a sample diagram contributing to the $\bbqqh$ channel at tree level. We employ the Fierz identity to write $(T^a)_{i_4}^{\;\;\bar{i}_3} (T^a)_{i_2}^{\;\;\bar{i}_1} = T_F \left( \delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3} - \frac{1}{N_c} \delta_{i_2}^{\;\;\bar{i}_1} \delta_{i_4}^{\;\;\bar{i}_3}\right)$. Note that particles 3 and 4 have to be crossed into the final state to correspond to the process definition in Eq.~\ref{eq:subprocessqq}, where all particles are outgoing. Thus, we should treat them as an outgoing antiquark and an outgoing quark, respectively, when applying the rules from Fig.~\ref{fig:colourinsertion}.} 
    \label{fig:bbqqHcolour}
\end{figure}

As an example, let us see how the operator product $\bm{T}_1 \cdot \bm{T}_4$ acts on the two colour structures in this channel. Applying the rules listed in Fig.~\ref{fig:colourinsertion} (remember that particle 4 is treated as an outgoing quark):
\begin{align}
    \bm{T}_1 \cdot \bm{T}_4 : \delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3} &= -(T^a T^a)_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3} = -C_F \delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3}\,, \\
    \bm{T}_1 \cdot \bm{T}_4 : \delta_{i_2}^{\;\;\bar{i}_1} \delta_{i_4}^{\;\;\bar{i}_3} &= -(T^a)_{i_2}^{\;\;\bar{i}_1} (T^a)_{i_4}^{\;\;\bar{i}_3} = -T_F \left(\delta_{i_4}^{\;\;\bar{i}_1}\delta_{i_2}^{\;\;\bar{i}_3} - \frac{1}{N_c}\delta_{i_2}^{\;\;\bar{i}_1} \delta_{i_4}^{\;\;\bar{i}_3} \right) \,,
\end{align}
where in both lines we have used the Fierz identity in the last equality. Perhaps a graphical representation of these operations in Fig.~\ref{fig:qqinsertion} is once again more illustrative. We can now read off the matrix $\mathcal{C}_{14}$:
\begin{equation}
    \mathcal{C}_{14} = 
    \begin{pmatrix}
    -C_F & 0 \\
    -T_F & \frac{T_F}{N_c}
\end{pmatrix}\,.
\end{equation}
In the same manner, we need to obtain the remaining matrices $\mathcal{C}_{ij}$. Needless to say, performing these operations by hand (or even using their diagrammatical equivalents) becomes tedious and extremely prone to errors. We therefore automate this task in \texttt{Mathematica} and make use of the package \texttt{ColorMath}~\cite{Sjodahl:2012nk} to achieve the simplifications of the various colour structures that arise as a result of applying the colour insertion operators. We also verify that Eq.~\ref{eq:poleinsertioncheckB} holds as a check on our calculations.
\begin{figure}
    \centering
    \begin{subfigure}{\linewidth}
        \begin{tikzpicture}
        	\begin{feynman}[small]
        		\vertex (i1) {$i_4$};
        		\vertex[right =3cm of i1] (f1) {$\bar{i}_1$};
        		\vertex[below =0.7cm of i1] (i2) {$\bar{i}_3$};
        		\vertex[right =3cm of i2] (f2) {$i_2$};			
        		
                %2nd diagram
                \vertex[right=of f1, xshift=0.8cm] (2i1) {$i_4$};
                \vertex[right=of f2, xshift=0.8cm] (2i2) {$\bar{i}_3$};
                		
        		\vertex[right=of 2i1] (2m1);
                \vertex[right=of 2m1] (2m2);
                
        		\vertex[right=of 2m2] (2f1) {$\bar{i}_1$};
                \vertex[below=0.7cm of 2f1] (2f2) {$i_2$}; 

                %3rd diagram
                \vertex[right=of 2f1, xshift=1cm] (3i1) {$i_4$};
                \vertex[right=of 2f2, xshift=1cm] (3i2) {$\bar{i}_3$};
                \vertex[right=3cm of 3i1] (3f1) {$\bar{i}_1$};
                \vertex[below=0.7cm of 3f1] (3f2) {$i_2$}; 
                
                %equation nodes
                \node (t1) [left=1.2cm of i1, yshift=-0.35cm] {$\bm{T}_1 \cdot \bm{T}_4:$};
                \node (t2) [right=5cm of t1] {$\;\;=\;\;-$};
                \node (t3) [right=5.3cm of t2] {$= \;\;-C_F$};

        		\diagram*{
                    %1st diagram
        			(i1) -- [anti fermion] (f1),
                    (i2) -- [fermion] (f2),
                    %2nd diagram
                    (2i1) -- (2m1) -- [anti fermion] (2m2) -- (2f1),
                    (2i2) -- [fermion] (2f2),
                    (2m1) -- [gluon, out=90, in=90] (2m2),
                    %3rd diagram
        			(3i1) -- [anti fermion] (3f1),
                    (3i2) -- [fermion] (3f2),
        		};
        	\end{feynman}
        \end{tikzpicture}
    \caption{}
    %\label{}
    \end{subfigure}
    \begin{subfigure}{\linewidth}
    \vspace{0.5cm}
        \begin{tikzpicture}
        	\begin{feynman}[small]
        		\vertex (i1) {$i_4$};
        		\vertex[below=2.3cm of i1] (i2) {$\bar{i}_3$};
                \vertex[right=of i1] (f1) {$\bar{i}_1$};
                \vertex[below=2.3cm of f1] (f2) {$i_2$};

                %2nd diagram
                \vertex[right=of f1, xshift=0.5cm] (2i1) {$i_4$};
                \vertex[below=of 2i1] (2im);
                \vertex[below=of 2im] (2i2) {$\bar{i}_3$};
                		
        		\vertex[right=of 2i1] (2f1) {$\bar{i}_1$};
        		\vertex[below=of 2f1] (2fm);
                \vertex[right=of 2i2] (2f2) {$i_2$}; 

                %3rd diagram
                \vertex[right=2.5cm of 2f1, yshift=-0.6cm] (3i1) {$i_4$};
        		\vertex[right =2cm of 3i1] (3f1) {$\bar{i}_1$};
        		\vertex[right=2.5cm of 2f2, yshift=0.8cm] (3i2) {$\bar{i}_3$};
        		\vertex[right =2cm of 3i2] (3f2) {$i_2$};

                %4th diagram
                \vertex[above right=of 3f1, xshift=1cm] (4i1) {$i_4$};
                \vertex[below right=of 3f2, xshift=1cm] (4i2) {$\bar{i}_3$};
                		
        		\vertex[right=of 4i1] (4f1) {$\bar{i}_1$};
                \vertex[right=of 4i2] (4f2) {$i_2$}; 

                %equation nodes
                \node (t1) [below left=1.5cm of i1, xshift=-0.2cm] {$\bm{T}_1 \cdot \bm{T}_4:$};
                \node (t2) [right=3cm of t1] {$\;\;=\;\;-$};
                \node (t3) [right=3cm of t2] {$= \;\;-T_F$ \Huge $\Biggr($};
                \node (t4) [right=4.2cm of t3] {$ -\,\,\dfrac{1}{N_c} $};
                \node (t5) [right=2.2cm of t4] {\Huge $\Biggr)$};

        		\diagram*{
                    %1st diagram
        			(i1) -- [anti fermion] (i2),
        			(f1) -- [fermion] (f2),
                    %2nd diagram
        			(2i1) -- [anti fermion] (2im) -- [anti fermion] (2i2),
        			(2f1) -- [fermion] (2fm) -- [fermion] (2f2),
                    (2im) -- [gluon] (2fm),
                    %3rd diagram
                    (3i1) -- [anti fermion] (3f1),
                    (3i2) -- [fermion] (3f2),
                    %4th diagram
                    (4i1) -- [anti fermion] (4i2),
                    (4f1) -- [fermion] (4f2),
        		};
        	\end{feynman}
        \end{tikzpicture}
    \caption{}
    %\label{}
    \end{subfigure}
    \caption{Diagrammatical representation of the action of the colour insertion operators $\bm{T}_1 \cdot \bm{T}_4$ on the colour factors (a): $\delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3}$ and (b): $\delta_{i_2}^{\;\;\bar{i}_1} \delta_{i_4}^{\;\;\bar{i}_3}\,.$} 
    \label{fig:qqinsertion}
\end{figure}

Once all the matrices $\mathcal{C}_{ij}$ have been computed, we have all the information needed to act with the pole operators $\bm{I}^{(L)}$ on the renormalised amplitudes $A_R^{(L)}$ and subtract the IR singularities. Note that if we want to retain full colour dependence, for each colour-ordered amplitude the subtraction will involve multiple lower-loop amplitudes with different colour factors. However, within the leading-colour approximation, the situation becomes much simpler. Indeed, replacing each $\bm{T}_i \cdot \bm{T}_j$ with the corresponding $\mathcal{C}_{ij}$ (and each $\bm{T}_i^2$ with the corresponding quadratic Casimir $C_i$), we retain only the highest power of $N_c$ to find:
\begin{equation}
    \bm{I}_{\bbqqh}^{(1)} = -N_c \frac{N(\eps)}{2}\left(\frac{1}{\eps^2} + \frac{3}{2\eps} \right) \left((-s_{23})^{-\eps} + (-s_{14})^{-\eps}\right)
    \begin{pmatrix}
        1 & 0 \\
        0 & 1
    \end{pmatrix}\,.
\end{equation}
Moreover, it turns out that the second colour factor $\delta_{i_2}^{\;\;\bar{i}_1} \delta_{i_4}^{\;\;\bar{i}_3}$ always appears suppressed by $1/N_c$ with respect to the first factor $\delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3}$, as can be appreciated from our simple example in Fig.~\ref{fig:bbqqHcolour}. Thus, in the leading-colour approximation, we simply drop it. This justifies the decomposition in Eq.~\ref{eq:colourdecomposition} and completes the derivation of the pole operator $I_{\bbqqh}^{(1)}$ in Eq.~\ref{eq:I1bbqqh}, which now acts solely on the amplitude associated with the colour factor $\delta_{i_4}^{\;\;\bar{i}_1} \delta_{i_2}^{\;\;\bar{i}_3}$.

Finally, we combine the UV and IR poles in a single operator $P^{(L)}$ which we can use to subtract both types of divergences from the amplitude. Substituting Eq.~\ref{eq:amprenorminbare} into Eqs.~\ref{eq:A1IRstructure} and \ref{eq:A2IRstructure}, we obtain the finite part:
\hspace{-9.2cm}
\begin{minipage}[t]{16cm}
\begin{align}
    F^{(1)} &= A_R^{(1)} - 2 I^{(1)}(\eps) A_R^{(0)} \nonumber \\
            &= A_B^{(1)} + 2 A_B^{(0)}(r_1 + s_1) - 2 I^{(1)}(\eps) A_B^{(0)} \nonumber \\
            &= A_B^{(1)} - \underbrace{2 \left(I^{(1)}(\eps) - r_1 - s_1 \right)}_{P^{(1)}} A_B^{(0)} \,, \\
            &\nonumber \\
    F^{(2)} &= A_R^{(2)} - 2 I^{(1)}(\eps) A_R^{(1)} - 4 I^{(2)}(\eps) A_R^{(0)} \nonumber \\
            &= A_B^{(2)} + 2 A_B^{(1)}(2r_1 + s_1) + 4A_B^{(0)} (r_2 + r_1 s_1 + s_2) \nonumber \\
            & \quad \, -2 I^{(1)}(\eps) \left(A_B^{(1)} + 2 A_B^{(0)}(r_1 + s_1)\right) - 4 I^{(2)}(\eps) A_B^{(0)} \nonumber \\
            &= A_B^{(2)} - \underbrace{\big(2 I^{(1)}(\eps) \big(\hat{A}_B^{(1)} + 2 r_1 + 2 s_1\big) +4I^{(2)}(\eps) -2 (2r_1 + s_1) \hat{A}_B^{(1)} -  4(r_2 + r_1 s_1 + s_2) \big)}_{P^{(2)}} A_B^{(0)}\,,
\end{align}
\end{minipage}
%\begin{align}
%    F^{(1)} &= A_R^{(1)} - 2 I^{(1)}(\eps) A_R^{(0)} \nonumber \\
%            &= A_B^{(1)} + 2 A_B^{(0)}(r_1 + s_1) - 2 I^{(1)}(\eps) A_B^{(0)} \nonumber \\
%            &= A_B^{(1)} - \underbrace{2 \left(I^{(1)}(\eps) - r_1 - s_1 \right)}_{P^{(1)}} A_B^{(0)} \,, \\
%            &\nonumber \\
%    F^{(2)} &= A_R^{(2)} - 2 I^{(1)}(\eps) A_R^{(1)} - 4 I^{(2)}(\eps) A_R^{(0)} \nonumber \\
%            &= A_B^{(2)} + 2 A_B^{(1)}(2r_1 + s_1) + 4A_B^{(0)} (r_2 + r_1 s_1 + s_2) \nonumber \\
%            & -2 I^{(1)}(\eps) \left(A_B^{(1)} + 2 A_B^{(0)}(r_1 + s_1)\right) - 4 I^{(2)}(\eps) A_B^{(0)} \nonumber \\
%            &= A_B^{(2)} - \big(2 I^{(1)}(\eps) \big(\hat{A}_B^{(1)} + 2 r_1 + 2 s_1\big) +4I^{(2)}(\eps) \nonumber  \\
%            &\phantom{=A_B^{(2)}-(} \underbrace{\quad \qquad -2 (2r_1 + s_1) \hat{A}_B^{(1)} -  4(r_2 + r_1 s_1 + s_2) \big)}_{P^{(2)}} A_B^{(0)}\,,
%\end{align}
where $\hat{A}_B^{(1)}$ is the one-loop bare amplitude divided by the tree-level amplitude. Thus, to obtain the finite remainders, we simply subtract the operators $P^{(1)}$ and $P^{(2)}$ (multiplied by the tree amplitude) from the \textit{bare} amplitudes $A^{(1)}_B$ and $A^{(2)}_B$.
\subsubsection{The $\bbggh$ channel}
The derivation of the pole structure of the $\bbggh$ follows exactly the same steps as described in the previous section. However, we believe it is still useful to outline it, since there are a few subtleties that we did not have to take care of in the case of the $\bbggh$ channel. First of all, here we find three colour factors:
\begin{equation}
    \bm{c} = 
    \begin{pmatrix}
        (T^{a_3}T^{a_4})_{i_2}^{\;\;\bar{i}_1} & \quad (T^{a_4}T^{a_3})_{i_2}^{\;\;\bar{i}_1}
        & \quad \delta_{i_2}^{\;\;\bar{i}_1} \delta^{ab}
    \end{pmatrix}^T\,.
\end{equation}
While the first two factors can be spotted in a naive analysis of tree-level diagrams such as Fig.~\ref{fig:bbggHcolour}, the third factor appears only at loop-level\JK{Check this is true.}. Thus, from a practical point of view, it is useful to have an automated routine which is able to extract the colour structure of all diagrams up to the desired loop order.
\begin{figure}
    \centering
        \begin{tikzpicture}
        	\begin{feynman}[small]
        		\vertex (v1);
          
        		\vertex[above left = 1cm of v1] (i1) {$a_4$};
        		\vertex[below left =  1cm of v1] (i2) {$a_3$};
        		\vertex[right = of v1] (v2);			
        		
        		\vertex[above right = 1cm of v2] (f1) {$\bar{i}_1$};
        		\vertex[below right = 1cm of v2] (f2) {$i_2$};

                %2nd diagram
                \vertex[below right=of f1, xshift=1cm] (2i1) {$a_4$};
                \vertex[above right=of f2, xshift=1cm] (2i2) {$a_3$};
                		
        		\vertex[right=2cm of 2i1] (2f2);
        		\vertex[above=0.5cm of 2f2] (2f1) {$\bar{i}_1$};
                \vertex[right=2cm of 2i2] (2f3); 
                \vertex[below=0.5cm of 2f3] (2f4) {$i_2$}; 

                %3rd diagram
                \vertex[right=1.2cm of 2f2, ] (3i1) {$a_4$};
                \vertex[right=1.2cm of 2f3, ] (3i2) {$a_3$};
                		
        		\vertex[right=2cm of 3i1] (3f2);
        		\vertex[above=0.5cm of 3f2] (3f1) {$\bar{i}_1$};
                \vertex[right=2cm of 3i2] (3f3); 
                \vertex[below=0.5cm of 3f3] (3f4) {$i_2$}; 
                
                \node (t1) [right=1.2cm of v2] {$\;\;=\;\;$};
                \node (t2) [right=3.7cm of t1] {$-$};

        		\diagram*{
                    %1st diagram
        			(i1) -- [gluon] (v1) -- [gluon] (i2),
                    (v1) -- [gluon] (v2),
        			(f1) -- [fermion] (v2) -- [fermion] (f2),
                    %2nd diagram
                    (2f1) -- [fermion] (2f2) -- [fermion] (2f3) -- [fermion] (2f4);
                    (2i1) -- [gluon] (2f2),
                    (2i2) -- [gluon] (2f3),
                    %3rd diagram
                    (3f1) -- [fermion] (3f2) -- [fermion] (3f3) -- [fermion] (3f4);
                    (3i1) -- [gluon] (3f3),
                    (3i2) -- [gluon] (3f2),
        		};
        	\end{feynman}
        \end{tikzpicture}
    \caption{The colour structure of a sample diagram contributing to the $\bbggh$ channel at tree level. It is also a graphical representation of the relation which defines the structure constants, $\ii f^{abc} (T^c)_{i_2}^{\;\;\bar{i}_1} = (T^aT^b)_{i_2}^{\;\;\bar{i}_1} - (T^bT^a)_{i_2}^{\;\;\bar{i}_1}\,$. \JK{I think there's an overall minus sign here.}} 
    \label{fig:bbggHcolour}
\end{figure}

Just as before, we apply all the needed combinations of the $\bm{T}_i \cdot \bm{T}_j$ operators on the colour structures in $\bm{c}$ and extract the matrices $\mathcal{C}_{ij}$. We then know how to act with the pole operator $\bm{I}_{\bbggh}^{(1)}$ on the renormalised amplitude $A_R^{(L)}$ in this channel. Again, in the leading colour approximation, the pole operator is diagonal, i.e. there is no mixing of different colour structures. However, contrary to $\bm{I}_{\bbqqh}^{(1)}$, it is not proportional to the identity matrix. We find:
\begin{equation*}
    \bm{I}_{\bbggh}^{(1)} = -N_c \frac{N(\eps)}{2}
    \begin{pmatrix}
        \mathrm{I}_1 & 0 & 0\\
        0 & \mathrm{I}_2 & 0\\
        0 & 0 & \mathrm{I}_3
    \end{pmatrix}\,,
\end{equation*}
where:
\begin{align}
    \mathrm{I}_1 = \mathrm{I}_2 &= \left(\frac{1}{\eps^2} + \frac{3}{4\eps} + \frac{\beta_0}{4 N_c \eps}\right) \left((-s_{23})^{-\eps} + (-s_{14})^{-\eps}\right) +\left(\frac{1}{\eps^2} + \frac{\beta_0}{2 N_c\eps} \right) (-s_{34})^{-\eps} \nonumber \\
    \mathrm{I}_3 &= \left(\frac{1}{\eps^2} + \frac{3}{2\eps} \right) (-s_{12})^{-\eps} + \left(\frac{2}{\eps^2} + \frac{\beta_0}{2 N_c \eps} \right) (-s_{34})^{-\eps}\,.
\end{align}
As in the previous section, the last colour factor is always suppressed by $1/N_c$ with respect to the first two and we simply drop it. This completes the derivation of the $\bbggh$ leading-colour decomposition Eq.\ref{eq:colourdecomposition} and its pole operator Eq.~\ref{eq:I1bbggh}.

A careful reader might be alarmed by the presence of the $\beta_0/N_c$ term at leading colour. Indeed, since $\beta_0 = \frac{11}{3}C_A - \frac{4}{3} T_F n_f$ and $C_A = N_c$, we would expect only the $11/3$ contribution to survive. However, in most practical applications, $n_f=4$ or $5$, thus $n_f/N_c \approx  \order{1}$. It is therefore reasonable to retain the $n_f$ term as well and the whole contribution is written in terms of the first $\beta$-function coefficient as $\beta_0/N_c$. This also provides the motivation for the decomposition in Eqs.~\ref{eq:NfDecomposition1L} and \ref{eq:NfDecomposition2L}.
\section{Pole structure of the QED process $0\to \ell \bar\ell \gamma \gamma^*$} \label{app:QEDpolestructure}
To derive the pole structure of the process $0\to \ell \bar\ell \gamma \gamma^*$ in Chapter~\ref{sec:QEDpaper}, we slightly depart from the procedure described above. In particular, in QED there is no colour structure, therefore applying the colour insertion operators would not make sense here. Instead, we follow the approach found in Refs.~\cite{Gardi:2009qi, Gardi:2009zv, Becher:2009cu, Becher:2009qa} and provide a brief outline below.

We renormalise the QED coupling constant by trading the bare coupling $\alpha_B$ for the renormalised one $\alpha_R$ through:
\begin{align}
    \label{eq:alpha-bare}
    \alpha_B = \alpha_R(\mu_R) \, Z_{\alpha}\bigl(\alpha_R(\mu_R) \bigr)  \, \mu_R^{2 \eps} \, S_{\eps} \,,
\end{align}
with $S_\eps=(4\pi)^{-\eps} \mathrm{e}^{\eps\gamma_E}$.
The renormalisation factor $Z_{\alpha}$ in the $\overline{\text{MS}}$ scheme is: \cite{Barnreuther:2013qvf,Bonciani:2021okt}
\begin{align}
    \label{eq:Za}
    Z_{\alpha}(\alpha) = 1 - \frac{\alpha}{4 \pi} \frac{\beta_0}{\eps} -
    \left(\frac{\alpha}{4 \pi}\right)^2 \left( -\frac{\beta_0^2}{\eps^2} + \frac{1}{2}\frac{\beta_1}{\eps} \right) + \mathcal{O}\bigl(\alpha^3\bigr) \,.
\end{align}
The QED $\beta$-function is defined from the renormalised coupling as:
\begin{align} \label{eq:beta_func_def}
\frac{\dd \alpha_{\rm R}(\mu_R)}{\dd \ln \mu_R} = \left[ -2 \, \eps + \beta\bigl(\alpha_{\rm R}(\mu_R)\bigr) \right]  \alpha_{\rm R}(\mu_R) \,,
\end{align}
and expanded as:
\begin{align} \label{eq:beta_func}
\beta( \alpha ) = -2 \, \frac{\alpha}{4 \pi}  \sum_{k\ge 0} \beta_k \left(\frac{\alpha}{4\pi} \right)^k \,,
\end{align}
with:
\begin{align} \label{eq:beta_coeffs}
\beta_0 = -\frac{4}{3} \nl \,, \qquad \qquad \beta_1 = - 4 \, \nl \,.
\end{align}
The photon wave function renormalisation factor is $Z_A=Z_\alpha$, which we include due to the external off-shell photon. The complete renormalisation procedure then is:
\begin{align}
    \mathcal{A}^\mu_\text{renorm}(\alpha_R) = Z_A^{\frac{1}{2}}(\alpha_R) \, \mathcal{A}^\mu_\text{bare}(\alpha_\text{bare}) \, ,
\end{align}
where $\alpha_B$ is expressed in terms of $\alpha_R$ through \cref{eq:alpha-bare}.

The IR poles of the renormalised amplitude factorise as~\cite{Catani:1998bh, Gardi:2009qi, Gardi:2009zv, Becher:2009cu, Becher:2009qa}:
\begin{align}
 \mathcal{A}^\mu_\text{renorm}(\alpha_R) = Z(\alpha_R) \,  \mathcal{F}^\mu(\alpha_R) \,,
\end{align}
so that $ Z(\alpha_R)$ captures all IR poles and $\mathcal{F}^\mu$ is a finite remainder.
We obtain the explicit two-loop expression of the IR factor $Z(\alpha_R)$ by
choosing QED parameters ($C_A=0$, $C_F=1$, and $T_F=1$) in the non-abelian gauge-theory expressions of \incite{Becher:2009qa}. We expand it as:
\begin{align}
    Z(\alpha) &= \sum_{k\ge0} Z^{(L)} \left(\frac{\alpha}{4\pi}\right)^L \,.
\end{align}
The coefficients $Z^{(L)}$ are expressed in terms of the anomalous dimension:
\begin{align}
    \Gamma &= \gamma^\text{cusp}\ln\left(\frac{-s_{12}}{\mu^2}\right)+2\gamma^l+\gamma^A \,,
\end{align}
and its derivative:
\begin{align}
    \Gamma^\prime &\coloneqq \frac{\partial\Gamma}{\partial\ln\mu} = -2\gamma^\text{cusp} \,.
\end{align}
Here, $\gamma^\text{cusp}$ is the cusp anomalous dimension, while $\gamma^l$ and $\gamma^A$ are the lepton's and the photon's collinear anomalous dimensions, respectively.
We expand all anomalous dimensions $y\in\{\Gamma,\gamma^i\}$ as:
\begin{align}
    y &= \frac{\alpha}{4\pi} \sum_{k\ge0} y_k \left(\frac{\alpha}{4\pi}\right)^k \,.
\end{align}
Their coefficients are listed in Appendix~\ref{app:renormconstants}. Finally, the coefficients of the IR factor $Z$ up to two loop are given by:
\begin{align}
    \label{eq:ir-pole-coeffs}
    Z^{(0)} &= 1 \,, &
    Z^{(1)} &= \frac{\Gamma_0^\prime}{4\eps^2}+\frac{\Gamma_0}{2\eps} \,, &
    Z^{(2)} &= \frac{{Z^{(1)}}^2}{2} -\frac{3\beta_0\Gamma_0^\prime}{16\eps^3}+\frac{\Gamma_1^\prime-4\beta_0\Gamma_0}{16\eps^2}+\frac{\Gamma_1}{4\eps} \,.
\end{align}
Putting together the subtraction of UV and IR poles, and expanding the resulting finite remainder $\mathcal{F}^{\mu}(\alpha_R)$ in $\alpha_R$ leads to the definitions in \cref{eq:finite-remainders}.

\chapter{Renormalisation Constants} \label{app:renormconstants}
\renewcommand{\theequation}{C.\arabic{equation}}
The bottom-quark Yukawa renormalisation constants are~\cite{Ahmed:2014pka,Mondini:2021nck}:
\begin{align}
r_1 & = -\frac{\beta_0}{2\eps}\,, \\
r_2 & = \frac{\beta_0^2}{4\eps^2} - \frac{\beta_1}{8\eps}\,, \\
s_1 & = -\frac{3 C_F}{2\eps} \,, \\
s_2 & = \frac{3}{8\eps^2}\big(3 C_F^2 + \beta_0 C_F \big) - \frac{1}{8\eps} \bigg( \frac{3 C_F^2}{2} + \frac{97}{6} C_F C_A -\frac{10}{3} C_F T_F n_f   \bigg) \,,
\end{align}
where the first two $\beta$ function coefficients are:
\begin{align}
    \beta_0 = & \;\frac{11}{3}C_A - \frac{4}{3} T_F n_f \,, \\
    \beta_1 = & \; \frac{34}{3} C_A^2 - \frac{20}{3} C_A T_F n_f - 4 C_F T_F n_f \,,
\end{align}
with $C_A = N_c$, $C_F = T_F(N_c^2-1)/N_c$.

The zeroth and first-order coefficients of the anomalous dimensions are given by~\cite{Becher:2009qa}: 
\begingroup
\allowdisplaybreaks
\begin{align}
\gamma_0^g = & \; -\frac{11}{3}C_A + \frac{4}{3} T_F n_f \,,   \\
\gamma_1^g = & \;  C_A^2 \left( -\frac{692}{27} + \frac{11\pi^2}{18} + 2 \zeta_3\right)
               + 4 C_F T_F n_f
               + C_A T_F n_f \left( \frac{256}{27} - \frac{2\pi^2}{9}\right) \,, \\
\gamma_0^q = & \; -3 C_F \,, \\
\gamma_1^q = & \; C_F^2 \left( -\frac{3}{2} + 2 \pi^2 - 24 \zeta_3 \right)
                  + C_F C_A \left( -\frac{961}{54} -\frac{11\pi^2}{6} + 26 \zeta_3 \right) \nn
             & \;  + C_F T_F n_f \left( \frac{130}{27} + \frac{2\pi^2}{3} \right) \,, \\
\gamma^l_0 = & -3 \,, \\
\gamma^l_1 = & -\frac{3}{2}+2\pi^2-24 \, \zeta_3+n_f\left(\frac{130}{27}+\frac{2}{3}\pi^2\right) \,, \\
\gamma^A_0 = & -\beta_0 \,, \\
\gamma^A_1 = & -\beta_1 \,, \\
\gamma_0^\cusp = & \; 4 \,, \\
\gamma_1^\cusp = & \; \left( \frac{268}{9} - \frac{4\pi^2}{3} \right) C_A -\frac{80}{9} T_F n_f \,.
\end{align}
\endgroup
We emphasise that while in QCD we have $N_c=3$ and $T_F = 1/2$, when working in QED one needs to set $C_A=0$, $C_F=1$ and $T_F=1$ in the expressions above.

\chapter{Definition of the four-point integral families} \label{app:int_def}
For each two-loop integral family $\tau$ corresponding to one of the maximal topologies shown in \cref{fig:int-fams}, the Feynman integrals have the form:
\begin{equation}
	j^{\tau}(a_1, \ldots, a_9) = \mathrm{e}^{2 \eps \gamma_{E}} \int \frac{\mathrm{d}^{4-2\eps} k_1}{\mathrm{i} \pi^{2-\eps}} \frac{\mathrm{d}^{4-2\eps} k_2}{\mathrm{i} \pi^{2-\eps}} \frac{1}{D_{\tau,1}^{a_1} \ldots D_{\tau,9}^{a_9}} \,.
\end{equation}
The sets $\{D_{\tau,1}, \ldots, D_{\tau,9}\}$ contain seven (inverse) propagators and two ISPs ($a_8, a_9 \le 0$). 
For the maximal topologies under consideration, they are given by:\footnote{We use a naming convention analogous to that of \incite{Abreu:2020jxa}.}
\begin{itemize}
	\item penta-triangle, \textbf{mzz} configuration:
		\begin{align} \begin{aligned}
			\big\{k_1^2,(k_1+p_1+p_2+p_3)^2,(k_1+p_2+p_3)^2,(k_1+p_3)^2,k_2^2,(k_2-p_3)^2,\\(k_1+k_2)^2,(k_2-p_1-p_2-p_3)^2,(k_2-p_2-p_3)^2\big\} \,,
		\end{aligned} \end{align}
	\item penta-triangle, \textbf{zmz} configuration:
		\begin{align} \begin{aligned}
		\big\{k_1^2,(k_1-p_1)^2,(k_1+p_2+p_3)^2,(k_1+p_3)^2,k_2^2,(k_2-p_3)^2,(k_1+k_2)^2,\\(k_2+p_1)^2,(k_2-p_2-p_3)^2 \big\} \,,
		\end{aligned} \end{align}
	\item penta-triangle, \textbf{zzz} configuration:
		\begin{align} \begin{aligned}
			\big\{k_1^2,(k_1-p_1)^2,(k_1-p_1-p_2)^2,(k_1-p_1-p_2-p_3)^2,k_2^2,(k_2+p_1+p_2+p_3)^2, \\ (k_1+k_2)^2,(k_2+p_1)^2,(k_2+p_1+p_2)^2\big\} \,,
		\end{aligned} \end{align}
	\item planar double-box:
		\begin{align} \begin{aligned}
			\big\{k_1^2,(k_1-p_1)^2,(k_1-p_1-p_2)^2,k_2^2,(k_2+p_1+p_2+p_3)^2,(k_2+p_1+p_2)^2, \\ (k_1+k_2)^2,(k_1-p_1-p_2-p_3)^2,(k_2+p_1)^2\big\} \,,
		\end{aligned} \end{align}
	\item crossed double-box, \textbf{mz} configuration:
		\begin{align} \begin{aligned}
			\big\{k_1^2,(k_1+p_1+p_2+p_3)^2,(k_1+p_2+p_3)^2,k_2^2,(k_2-p_2)^2,(k_1+k_2)^2,\\ (k_1+k_2+p_3)^2,(k_1+p_3)^2,(k_2-p_1-p_2-p_3)^2\big\} \,,
		\end{aligned} \end{align}
	\item crossed double-box, \textbf{zz} configuration:
		\begin{align} \begin{aligned}
			\big\{k_1^2,(k_1-p_1)^2,(k_1-p_1-p_2)^2,k_2^2,(k_2-p_3)^2,(k_1+k_2)^2, \\ (k_1+k_2-p_1-p_2-p_3)^2,(k_1-p_1-p_2-p_3)^2,(k_2+p_1)^2\big\} \,.
		\end{aligned} \end{align}
\end{itemize}
%
We also use the one-loop (one-mass) box family, made of the following integrals:
\begin{equation}
	j^{\rm box}(a_1, a_2, a_3, a_4) = \mathrm{e}^{\eps \gamma_{E}} \int \frac{\mathrm{d}^{4-2\eps} k}{\mathrm{i} \pi^{2-\eps}} \frac{1}{D_{\mathrm{box}, 1}^{a_1} D_{\mathrm{box},2}^{a_2} D_{\mathrm{box},3}^{a_3} D_{\mathrm{box},4}^{a_4}} \,,
\end{equation}
with the four inverse propagators $D_{\mathrm{box},i}$:
	\begin{equation}
		\big\{k_1^2, (k_1-p_1)^2, (k_1-p_1-p_2)^2, (k_1-p_1-p_2-p_3)^2 \big\} \,.
	\end{equation}
Feynman's prescription for the imaginary parts of all propagators is implicit.

These family definitions (strictly with the ordering of inverse propagators and ISPs shown above) correspond to the integrals \texttt{j[family,$a_1,$\ldots]} that build the canonical MI bases provided in the \texttt{pure\_mi\_bases/} directory of our ancillary files~\cite{zenodo}. In this notation, each \texttt{j[...]} represents a Feynman integral within a given integral family, while the numbers $a_i$ refer to the powers of its propagators and ISPs.

\chapter{Analytic continuation} \label{app:an_cont}
In Chapter~\ref{sec:QEDpaper}, we analytically continue the MPLs by adding a small positive (or negative) imaginary part to the MPL indices $l_i$ in \cref{eq:indices} whenever they fall between $0$ and $1$. The imaginary part of each index prescribes how to deform the integration contour around the pole associated with it. We do similarly for the logarithms in \cref{eq:logs}.
To this end, following \incite{Gehrmann:2002zr}, we change variables from $(s_{12},s_{23},s_4)$ to $(s_{12},s_{23},s_{13})$, with $s_4 = s_{12} + s_{23} + s_{13}$. We then add a small positive imaginary part to the latter variables, as
\begin{align} \label{eq:add_im}
s_{12} \longrightarrow s_{12} + \mathrm{i} \, c_{1} \, \delta \, , \qquad
s_{23} \longrightarrow s_{23} + \mathrm{i} \, c_{2} \, \delta  \, , \qquad
s_{13} \longrightarrow s_{13} + \mathrm{i} \, c_{3} \, \delta  \, , 
\end{align}
where $c_{1}$, $c_{2}$ and $c_{3}$ are arbitrary positive constants, and $\delta$ is a positive infinitesimal. 
Finally, we check whether this substitution gives a positive or negative imaginary part to each MPL index $l_i$.
This depends on the domain of the kinematic variables.
We focus on three kinematic regions which are of phenomenological interest. The analytic continuation for any other region may be obtained similarly.

\smallskip

\paragraph{Electron-line corrections to $e^- \mu^- \to e^- \mu^- \gamma$.}
To define the domain of the kinematic variables relevant for this application, 
we embed the four-particle off-shell process of \cref{eq:scatter} in the five-particle process $e^- \mu^- \to e^- \mu^- \gamma$. We then determine the kinematic constraints for the five-particle process (see e.g. Appendix~A of \incite{Chicherin:2021dyp}), and from them derive the constraints on the four-point off-shell kinematics. The result is
\begin{align}
\label{eq:region_emu-emugamma}
\mathcal{P}_{e\mu\to{e}\mu\gamma} \coloneqq \{\vec{s} \colon s_{12} < 0 \, \land \, s_{23} < 0 \, \land \, 0 < s_{13} < -s_{12} - s_{23} \} \,.
\end{align}
The MPL index $l_4 = - s_{12}/s_{23}$ is always negative in $\mathcal{P}_{{e}\mu\to{e}\mu\gamma}$, hence no analytic continuation is required. The other three indices may instead fall between $0$ and $1$. Let us study $l_1$. Changing variables from $s_4$ to $s_{13}$ and adding imaginary parts as in \cref{eq:add_im} gives
\begin{align}
l_1 = \frac{s_{12} + s_{13} + s_{23}}{s_{12}} +  \frac{\mathrm{i} \delta}{s_{12}^2} \left[ (c_2 + c_3) s_{12} - c_1 (s_{13} + s_{23}) \right] + \mathcal{O}\left(\delta^2\right) \,.
\end{align}
The imaginary part of $l_1$ may be either negative or positive in $\mathcal{P}_{{e}\mu\to{e}\mu\gamma} $. However, it is strictly negative in the subregion of $\mathcal{P}_{{e}\mu\to{e}\mu\gamma} $ where $0<l_1<1$. We therefore assign a negative imaginary part to $l_1$ whenever $0<l_1<1$ in $\mathcal{P}_{{e}\mu\to{e}\mu\gamma} $. The analysis of the other indices follows similarly, and is summarised in \cref{tab:an_cont}.
The arguments of the three logarithms in \cref{eq:logs} are positive in $\mathcal{P}_{e\mu\to{e}\mu\gamma}$.

\begin{table}
    \centering
    \begin{tabular}{cccc}
        \hline
        Index & $\mathcal{P}_{{e}\mu\to{e}\mu\gamma}$ & $\mathcal{P}_{{e}\bar{{e}}\to\gamma \gamma^*}$ & $\mathcal{P}_{\gamma^*\to e \bar{e} \gamma}$  \\
        \hline
        $l_1$  & $-$ & $+$ & $0$ \\
        $l_2$  & $-$ & $0$ & $0$ \\
        $l_3$  & $-$ & $0$ & $0$ \\
        $l_4$  & $0$ & $0$ & $0$ \\
        \hline
    \end{tabular}
    \caption{Imaginary parts of the MPL indices defined by \cref{eq:indices} in the two kinematic regions discussed in \cref{app:an_cont}. The symbol $+$ ($-$) denotes a positive (negative) imaginary part, while $0$ means no analytic continuation is needed.}
    \label{tab:an_cont}
\end{table}

\smallskip

\paragraph{Corrections to $e^- e^+ \to \gamma \gamma^*$.} The relevant domain of the kinematic variables in this case can be derived directly for the four-point kinematics, and is typically named the $s_{12}$ channel. It is given by 
\begin{align}
\label{eq:region_eebar}
\mathcal{P}_{e\bar{e}\to\gamma\gamma^*} \coloneqq \{\vec{s} \colon s_{23} < 0 \, \land \, s_{13} < 0 \, \land \, s_{12} > - s_{23} - s_{13} \} \,.
\end{align}
The MPL indices $l_2$, $l_3$ and $l_4$ can never fall between $0$ and $1$ in $\mathcal{P}_{e\bar{e}\to\gamma\gamma^*}$, and hence require no analytic continuation. We instead need to add a positive imaginary part to $l_1$. 
In this region also the logarithms in \cref{eq:logs} need to be analytically continued. The argument of $\log(s_{12}/s_4)$ is positive in $\mathcal{P}_{e\bar{e}\to\gamma\gamma^*}$. By adding imaginary parts to the arguments of the other logarithms and studying them where the arguments are negative in $\mathcal{P}_{e\bar{e}\to\gamma\gamma^*}$, we determine that the analytic continuation is achieved through the following replacements:
\begin{align}
\log(s_{23}/s_4) \longrightarrow \log(-s_{23}/s_{4})+ \mathrm{i} \pi \,, \qquad  \log(-s_4) \longrightarrow \log(s_4)- \mathrm{i} \pi \,.
\end{align}


\paragraph{Corrections to the decay $\gamma^* \to e^- e^+ \gamma$.} The relevant domain of the kinematic variables~is
\begin{align}
\label{eq:region_decay}
\mathcal{P}_{\gamma^*\to e \bar{e} \gamma} \coloneqq  \{ \vec{s} \colon s_{12} > 0 \, \land \, s_{23} > 0 \, \land \,  s_{13} > 0 \} \,.
\end{align}
All MPL indices $l_i$ in \cref{eq:indices} are either $l_i < 0$ or $l_i > 1$, hence no analytic continuation is required. The same holds for the first two logarithms in \cref{eq:logs}, whose arguments are positive. The only function which needs to be analytically continued is $\log(-s_4)$. We achieve this by replacing
\begin{align}
\log(-s_4) \longrightarrow \log(s_{4}) - \mathrm{i} \pi \,.
\end{align}

\smallskip

The information about the imaginary parts of the MPL indices can be fed into the publicly available libraries for evaluating these functions numerically, such as \texttt{FastGPL}~\cite{Wang:2021imw}, \texttt{GiNaC}~\cite{Bauer:2000cp,Vollinga:2004sn}, and \texttt{handyG}~\cite{Naterop:2019xaf}. This typically leads to longer evaluation times with respect to MPLs which do not need analytic continuation. We find that this is not an issue for the planned applications of our results (see \cref{sec:performance}). Nonetheless, we note that a more performant evaluation may be achieved by tailoring the representation to the kinematic region of interest in such a way that no MPLs require analytic continuation. We refer to \incite{Gehrmann:2002zr,Gehrmann:2023etk} for a detailed discussion. 
\end{document}